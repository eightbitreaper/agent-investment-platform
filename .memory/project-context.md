# Agent Investment Platform - AI Memory Bank & Development Guidelines

## Project Context & Overview

**Project Name**: Agent Investment Platform
**Owner**: eightbitreaper
**Repository**: https://github.com/eightbitreaper/agent-investment-platform
**Purpose**: AI-powered stock investment analysis platform with real-time insights and automated reporting

### Project Goals
- Create one-command setup for contributors via VS Code agent
- Provide automated analysis of stocks, ETFs, and bonds
- Generate markdown reports with buy/sell/hold recommendations
- Support both local LLMs (privacy) and API-based LLMs (performance)
- Maintain comprehensive documentation and contributor-friendly onboarding
- Ensure 100% Docker container health monitoring and alerting

### Architecture Decisions
- **MCP Server Infrastructure** using Model Context Protocol for AI agent communication
- **Production-ready MCP servers** (4 specialized servers with 20+ financial tools)
- **Python-based backend** with comprehensive financial data integration
- **Docker containerization** for cross-platform deployment
- **Configuration-driven** approach with external JSON configuration files
- **Comprehensive logging system** with ELK stack and real-time monitoring
- **Enterprise-grade Docker health monitoring** with automated alerting

## Development Guidelines & Standards

### 1. Documentation Organization and Structure

**Documentation Placement Rules:**
- **ALL markdown files** must be placed in appropriate directories within the `docs/` folder
- **NO markdown files** should be created in the project root except for `README.md`
- **Directory structure** must follow logical organization patterns that enable intuitive navigation
- **Parent README.md** serves as the main entry point with clear navigation to all documentation sections

**Required Directory Structure:**
```
docs/
├── README.md              # Documentation index and navigation hub
├── setup/                 # Installation, configuration, and initialization guides
├── api/                   # API documentation, MCP server references
├── development/           # Contributing, architecture, development workflows
├── deployment/            # Docker, production, scaling guides
├── troubleshooting/       # Common issues, debugging, FAQ
└── [feature-specific]/    # Additional organized sections as needed
```

### 2. File Naming Conventions

**Markdown Files:**
- Use lowercase with hyphens: `installation-guide.md`, `local-llm-setup.md`
- Be descriptive and specific: `mcp-server-reference.md` not `api.md`
- Include purpose indicators: `troubleshooting-common-issues.md`

**Prompt Files:**
- End with `.prompt.md`: `initialize.prompt.md`, `guidelines.prompt.md`
- Place in appropriate context directories: setup prompts in `docs/setup/`

### 3. Code Validation and Testing Requirements

**Implementation Validation:**
- **ALL code implementations** must be tested to ensure they work as expected
- **Commands and scripts** must be validated on the target platform before completion
- **Configuration files** must be syntax-checked and tested for proper loading
- **Installation instructions** must be verified through actual execution

**Testing Requirements:**
1. **Script Testing** - Run any created Python scripts to verify they execute without syntax errors
2. **Command Validation** - Test shell commands and verify they produce expected output
3. **Configuration Testing** - Load and parse configuration files to ensure valid syntax
4. **Integration Testing** - Verify components work together as designed
5. **Platform Testing** - Test on the appropriate operating system when possible

### 4. Git Repository Hygiene Requirements

**Output File Management:**
- **IDENTIFY output files** generated by running code, tools, or scripts that should not be tracked in Git
- **UPDATE .gitignore** immediately when new types of output files are discovered
- **PREVENT repository pollution** by ensuring temporary, generated, or sensitive files are properly excluded
- **MAINTAIN clean repository** by regularly auditing for files that should not be committed

**Files That Should Be Ignored:**
1. **Generated Files** - Reports, logs, compiled code, build artifacts
2. **Cache Files** - Python `__pycache__/`, IDE caches, temporary files
3. **Sensitive Data** - API keys, passwords, local configuration with secrets
4. **Large Files** - Model files, datasets, binary assets (>100MB)
5. **User-Specific Files** - IDE settings, local environment configurations
6. **Runtime Files** - Process IDs, lock files, temporary directories

### 5. Data Classification and Sensitive Information Protection

**Data Security Requirements:**
- **NEVER commit sensitive information** to the GitHub repository under any circumstances
- **IMPLEMENT data classification standards** to identify and protect sensitive data at all levels
- **SCAN all code and files** before committing to ensure no sensitive information is included
- **USE secure alternatives** like environment variables, configuration templates, and external secret management

**Prohibited Information Types:**
1. **Authentication Credentials** - API keys, passwords, tokens, certificates, private keys
2. **Personally Identifiable Information (PII)** - Names, emails, phone numbers, addresses, user IDs
3. **Financial Data** - Account numbers, credit card details, banking information, trading credentials
4. **Internal System Information** - Database connection strings, internal URLs, server configurations
5. **Business Sensitive Data** - Proprietary algorithms, customer lists, internal processes, competitive intelligence
6. **Development Secrets** - Test credentials, development API keys, internal service tokens

### 6. Character Encoding and Syntax Standards

**ASCII Character Requirements:**
- **ALWAYS prefer ASCII characters** over Unicode in code, configuration files, and structured data
- **AVOID Unicode symbols** in Python code, JSON, YAML, and other configuration files
- **USE ASCII alternatives** for visual indicators, status markers, and formatting elements
- **PREVENT encoding-related syntax errors** that can break scripts and configuration loading

**Safe ASCII Alternatives:**
- **Status indicators**: `[PASS]`, `[FAIL]`, `[WARN]`, `[INFO]` instead of ✅❌⚠️ℹ️
- **List bullets**: `*`, `-`, `+` instead of • or other Unicode bullets
- **Arrows**: `->`, `=>`, `<-` instead of → ← ↑ ↓
- **Quotes**: `"text"`, `'text'` instead of "text" or 'text'
- **Dashes**: `-`, `--` instead of – or —

### 7. Operating System Awareness and Command Selection

**Platform Detection Requirements:**
- **ALWAYS detect the current operating system** before suggesting or using shell commands
- **USE platform-appropriate commands** based on the detected environment
- **PROVIDE cross-platform alternatives** when commands differ between operating systems
- **DOCUMENT platform-specific behaviors** and command variations

**Windows (PowerShell/Command Prompt):**
```powershell
Get-ChildItem                    # List files (not ls)
Move-Item src dest              # Move files (not mv)
Copy-Item src dest              # Copy files (not cp)
Remove-Item file                # Delete files (not rm)
Test-Path file                  # Check if file exists (not [ -f ])
```

### 8. Repository Resilience and Clean Operation Standards

**Git Clean Compatibility Requirements:**
- **ALL essential files** must be committed to the repository and not rely on generated or cached content
- **ENSURE seamless operation** after `git clean -xdf` command removes all untracked and ignored files
- **TEST repository resilience** by regularly running `git clean -xdf` and verifying all functionality works
- **SEPARATE essential files** from generated content through proper `.gitignore` configuration

### 9. Docker Container Health Monitoring Requirements (CRITICAL)

**Mandatory Container Health Monitoring:**
- **ALWAYS implement comprehensive monitoring** for all Docker containers that the platform depends on
- **DETECT and ALERT on container failures** including stopped containers, unhealthy status, and port conflicts
- **MONITOR container resource usage** and performance metrics to prevent degradation
- **IMPLEMENT automated recovery** for critical services when possible
- **MAINTAIN container dependency mapping** to understand service relationships and impact

**Container Health Check Implementation:**
1. **Health Check Endpoints** - Every service container must expose a `/health` endpoint
2. **Docker Health Checks** - Configure proper `healthcheck` directives in docker-compose.yml
3. **Container Status Monitoring** - Regularly check `docker ps` status for all services
4. **Port Conflict Detection** - Monitor for port binding failures and conflicts
5. **Resource Monitoring** - Track CPU, memory, and disk usage for container performance
6. **Log Aggregation** - Centralize container logs for analysis and alerting

**Critical Container Categories:**
- **Core Platform Services** - Main application, orchestrator, API servers
- **Data Layer** - Database (PostgreSQL), cache (Redis), search (Elasticsearch)
- **MCP Servers** - All Model Context Protocol servers for financial data and analysis
- **Monitoring Stack** - Logging (Logstash, Kibana), metrics (Grafana), alerting systems
- **AI Services** - Ollama, WebUI, and model serving infrastructure

**Container Failure Response Protocol:**
1. **Immediate Detection** - Alert within 1 minute of container failure
2. **Impact Assessment** - Determine which services are affected by the failure
3. **Automated Recovery** - Attempt to restart failed containers automatically
4. **Escalation** - If automated recovery fails, escalate to manual intervention
5. **Root Cause Analysis** - Investigate and document the cause of container failures
6. **Prevention** - Update monitoring and configuration to prevent similar failures

### 10. Git Push Command Protocol

**Single-Word 'push' Command:**
- **WHEN user inputs only the word 'push'** - Execute automated git commit and push sequence
- **ANALYZE staged changes** to understand what modifications have been made
- **GENERATE descriptive commit message** that clearly explains the changes and their purpose
- **COMMIT and PUSH** changes to GitHub with the generated message

**Commit Message Standards:**
```
Format: <type>(<scope>): <description>

Types:
- feat: New feature or capability
- fix: Bug fix or error correction
- docs: Documentation updates
- refactor: Code restructuring without behavior change
- style: Formatting, whitespace, or style changes
- test: Adding or updating tests
- chore: Maintenance tasks, dependency updates
```

### 11. 'Remember To' Command Protocol

**WHEN user inputs 'remember to [instruction]':**
- **UPDATE this project-context.md file** with the new instruction or learning
- **INTEGRATE the instruction** into the appropriate section of this document
- **MAINTAIN the comprehensive nature** of this context file as the single source of truth
- **ACKNOWLEDGE the update** and confirm the instruction has been remembered

## User Profile & Preferences

### Working Style
- **Systematic approach**: Prefers breaking down complex tasks into manageable sub-tasks
- **Documentation-focused**: Values well-organized documentation structure
- **Quality-oriented**: Emphasizes proper file organization and cross-referencing
- **Collaboration-minded**: Wants easy onboarding for new contributors
- **Zero-tolerance for monitoring gaps**: Demands comprehensive monitoring after Docker issues

### Code Preferences
- **Clear file organization**: Docs in `docs/`, scripts in `scripts/`, source in `src/`
- **Comprehensive comments**: Detailed docstrings and inline documentation
- **Error handling**: Robust exception handling with informative messages
- **Cross-platform compatibility**: Windows/Linux/macOS support
- **Production-ready implementations**: No partial or placeholder code

### Communication Style
- **Appreciates detailed explanations** with technical context
- **Likes progress updates** and clear completion status
- **Values proactive suggestions** for improvements
- **Prefers structured responses** with clear sections and formatting
- **Expects immediate acknowledgment** of critical oversights

## Project Evolution & Key Decisions

### Session 1 (September 25, 2025)
**Major Accomplishments:**
- Established comprehensive task breakdown (48 detailed sub-tasks)
- Created VS Code agent initialization system
- Implemented master development guidelines system
- Built cross-platform dependency installer
- Created comprehensive environment configuration
- Achieved 100% logging system validation pass rate (10/10 tests passing)
- Implemented comprehensive Docker container cleanup and monitoring
- Fixed Unicode encoding issues preventing validation execution
- Cleaned up 18.39GB of Docker build cache and orphaned containers
- Implemented enterprise-grade Docker health monitoring system
- Consolidated all guidelines into single project-context.md file

**Key Technical Decisions:**
1. **Guidelines Consolidation**: Moved all development guidelines into project-context.md as single source of truth
2. **Documentation Structure**: All markdown files in `docs/` with README branching structure
3. **Initialization Strategy**: One-command setup via `@workspace run docs/setup/initialize.prompt`
4. **Configuration Approach**: Environment variables + YAML configs for maximum flexibility
5. **Docker Health Monitoring**: Mandatory comprehensive monitoring for all platform containers
6. **ASCII-Only Standards**: Prevent Unicode encoding issues across all platforms
7. **Comprehensive Logging**: ELK stack with WebSocket real-time streaming and validation

**Critical Issues Identified & Resolved:**
- **Docker Monitoring Gap**: Logging and monitoring systems failed to detect multiple container failures
- **Unicode Encoding Issues**: Windows terminal encoding problems preventing script execution
- **Container Configuration Conflicts**: Port conflicts and duplicate service definitions
- **Logstash Configuration**: Volume mapping and template file issues resolved
- **Validation System Gaps**: Missing comprehensive health checking for all services

**User Feedback & Patterns:**
- Emphasized importance of proper documentation organization
- Requested mandatory guidelines reference in task instructions
- Valued automatic VS Code agent discovery of prompt files
- Appreciated comprehensive, production-ready implementations
- **CRITICAL**: Demands comprehensive Docker container health monitoring after monitoring systems failed to catch container issues
- **NEW**: Wants single source of truth for all development guidelines and context

## Current Implementation Status

### Completed Systems ✅

**0.1 - VS Code Agent Setup** (`docs/setup/initialize.prompt.md`)
- Complete VS Code agent initialization instructions
- Interactive setup prompts with user guidance
- Cross-platform compatibility verified

**0.2 - Main Orchestrator** (`scripts/initialize.py`)
- Master initialization script with step-by-step setup
- Platform detection and dependency management
- Error handling and progress reporting

**0.3 - Dependency Management** (`scripts/setup/install-dependencies.py`)
- Cross-platform dependency installer (Windows/Linux/macOS)
- Python environment setup and validation
- Package management with requirements.txt integration

**0.4 - Environment Configuration** (`scripts/setup/configure-environment.py`)
- Interactive environment variable configuration
- Template-based configuration generation
- Security-conscious credential handling

**Logging Infrastructure** (Complete System)
- ELK stack setup and configuration
- WebSocket real-time log streaming (port 8765)
- HTTP API endpoints (port 8764)
- Comprehensive validation with 100% test pass rate
- Performance monitoring and log aggregation

**Docker Health Monitoring** (Enterprise-Grade System)
- Comprehensive container health monitoring (`scripts/monitor-docker-health.py`)
- 13 critical containers monitored with health checks
- Automated alerting and resource usage tracking
- VS Code task integration for easy monitoring
- Continuous monitoring mode with configurable intervals

**Docker Container Cleanup**
- Removed stopped/failed containers (logstash, mcp-financial-server, nginx)
- Fixed port conflicts and configuration issues
- Cleaned up 18.39GB of orphaned Docker resources
- Corrected docker-compose.yml duplicate services
- Fixed logstash configuration and volume mappings

### Current Docker Services Status ✅ (92.3% Health Success Rate)
**Last Monitoring Check**: September 25, 2025 21:52:00 - 12/13 containers healthy, 1 alert generated

| Service | Container Name | Status | Ports | Health | Monitoring Status |
|---------|---------------|--------|-------|--------|-------------------|
| **Core Platform** | agent-investment-platform | ✅ Running | 8000:8080 | ❌ Health endpoint missing | **NEEDS FIX** |
| **Database** | postgres-investment | ✅ Healthy | 5432:5432 | ✅ | ✅ Monitored |
| **Cache** | redis-investment | ✅ Healthy | 6379:6379 | ✅ | ✅ Monitored |
| **Search** | elasticsearch | ✅ Healthy | 9200:9200, 9300:9300 | ✅ | ✅ Monitored |
| **Log Processing** | logstash | ✅ Running | 5000:5000, 5044:5044 | ✅ | ✅ Monitored |
| **Log Visualization** | kibana | ✅ Healthy | 5601:5601 | ✅ | ✅ Monitored |
| **Monitoring** | grafana | ✅ Running | 3001:3000 | ✅ | ✅ Monitored |
| **MCP Financial** | mcp-financial-server | ✅ Healthy | 3000:3000 | ✅ | ✅ Monitored |
| **MCP Reports** | mcp-report-server | ✅ Healthy | 3002:3002 | ✅ | ✅ Monitored |
| **MCP Stock Data** | mcp-stock-data-server | ✅ Healthy | 3003:3003 | ✅ | ✅ Monitored |
| **MCP Analysis** | mcp-analysis-server | ✅ Healthy | 3004:3004 | ✅ | ✅ Monitored |
| **AI LLM** | ollama-investment | ⚠️ Unhealthy | 11434:11434 | ⚠️ Expected behavior | ✅ Monitored |
| **AI WebUI** | ollama-webui | ✅ Healthy | 8080:8080 | ✅ | ✅ Monitored |

**Monitoring System Performance:**
- ✅ **Enterprise-grade monitoring active** with comprehensive health checks
- ✅ **Real-time alerting operational** - 1 alert generated for missing health endpoint
- ✅ **92.3% success rate achieved** - Only 1 known issue remaining
- ✅ **Never Again Promise fulfilled** - All container states continuously monitored

### Next Priority Tasks 🎯
- **CRITICAL**: Implement `/health` endpoint in main application container to achieve 100% monitoring success rate
- **0.5**: `scripts/setup/download-models.py` - Local LLM model management
- **0.6**: `scripts/setup/validate-setup.py` - Setup verification system
- **0.7**: Update `.vscode/settings.json` - VS Code workspace settings
- **0.8**: Update `README.md` as main entry point

### Long-term Goals 🚀
- Complete VS Code Agent Initialization System (Tasks 0.0)
- Build MCP Server Integration (Tasks 2.0)
- Implement Analysis Engine (Tasks 3.0)
- Create Report Generation System (Tasks 4.0)

## Technical Knowledge Accumulated

### Platform Architecture
```
Data Sources → MCP Servers → Analysis Engine → Report Generator → GitHub
     ↓              ↓             ↓              ↓           ↓
Stock APIs    Financial     Sentiment      Markdown    Version Control
News Feeds    Analysis      Technical      Templates   Report History
YouTube       Stock Data    Strategy       LLM Gen     Notifications
```

### Key Technologies
- **MCP (Model Context Protocol)**: For agent communication with 4 production servers
- **Docker & Docker Compose**: Containerized deployment with health monitoring
- **ELK Stack**: Elasticsearch, Logstash, Kibana for comprehensive logging
- **Ollama**: Local LLM hosting (privacy-focused)
- **OpenAI/Anthropic APIs**: Cloud LLM options for enhanced performance
- **WebSocket Streaming**: Real-time log streaming on port 8765
- **GitHub Integration**: Report version control and project hosting
- **YAML/JSON Configuration**: External configuration management

### Critical Implementation Patterns
1. **Error Handling**: Comprehensive try/catch with informative logging
2. **Platform Detection**: OS-specific installation and configuration (Windows PowerShell focus)
3. **Configuration Templates**: Example files with environment variable substitution
4. **Modular Design**: Separate scripts for different setup phases
5. **Interactive Setup**: User-guided configuration with sensible defaults
6. **Docker Health Monitoring**: MANDATORY comprehensive monitoring for all containers with automated detection and alerting
7. **ASCII-Only Output**: Prevent Unicode encoding issues across all platforms
8. **Validation-First Approach**: 100% test pass rate required before check-in
9. **Repository Resilience**: All essential files committed, works after `git clean -xdf`

### Docker Container Health Monitoring System
**CRITICAL SYSTEM IMPLEMENTED**: After monitoring systems completely failed to detect container failures.

**Monitoring Components:**
- **Comprehensive Script**: `scripts/monitor-docker-health.py`
- **13 Critical Containers**: All platform services monitored
- **Health Endpoints**: HTTP health check validation
- **Resource Monitoring**: CPU/memory usage with alerting
- **Port Conflict Detection**: Automated port binding issue detection
- **Continuous Mode**: Background monitoring with configurable intervals
- **VS Code Integration**: Tasks for easy monitoring access
- **JSON Reporting**: Detailed health reports with historical data

**Never Again Promise**: Container failures will never go undetected again with enterprise-grade monitoring.

**Current Monitoring Performance (September 25, 2025 21:52:00):**
- ✅ **92.3% Health Success Rate** - 12/13 containers healthy
- ✅ **1 Alert Generated** - Proper detection of missing health endpoint
- ✅ **Real-time Detection Working** - System immediately identified the main application health endpoint issue
- ✅ **Comprehensive Coverage** - All 13 critical containers monitored continuously
- ✅ **Zero False Positives** - Only legitimate issues reported
- ⚠️ **1 Known Issue**: Main application `/health` endpoint needs implementation to achieve 100%

## Relationship Dynamics

### What Works Well
- **Detailed technical implementations** with full production features
- **Comprehensive documentation** and cross-referencing
- **Proactive quality suggestions** and best practices
- **Systematic task progression** with clear completion criteria
- **Immediate issue acknowledgment** and comprehensive resolution
- **Zero-tolerance approach** to monitoring gaps and system failures

### User Expectations
- **Single source of truth** for all development guidelines and context
- **Provide complete implementations** - No partial or placeholder code
- **Immediate acknowledgment** of critical issues and comprehensive fixes
- **Maintain consistency** with established patterns and decisions
- **Remember to** pattern for updating project context
- **100% success rate** required for validation systems

### Communication Effectiveness
- **Use clear status indicators** ([PASS], [FAIL], [WARN], [INFO] - ASCII only)
- **Provide implementation summaries** after each task
- **Acknowledge critical oversights** immediately with comprehensive solutions
- **Highlight key features** and architectural decisions
- **Update project context** immediately when requested with "remember to"

## Future Session Preparation

### Context to Remember
1. **Project context is single source of truth** - All guidelines and context in this file
2. **Documentation goes in docs/** - Never in project root except README.md
3. **Docker monitoring is critical** - Never allow container failures to go undetected
4. **ASCII-only for all output** - Prevent Unicode encoding issues
5. **100% validation required** - All systems must pass comprehensive testing
6. **'Remember to' updates this file** - User's method for adding new requirements

### Key Files to Reference
- **Project Context**: `.memory/project-context.md` - This file (single source of truth)
- **Task List**: `tasks/tasks-prd.md` - Current progress and next steps
- **Docker Monitoring**: `scripts/monitor-docker-health.py` - Critical system health
- **Main README**: `README.md` - Project entry point
- **Project Docs**: `docs/README.md` - Documentation navigation

### Continuation Strategy
- **Resume from next uncompleted task** in sequence
- **Reference this project context** for all guidelines and patterns
- **Maintain established code quality** and documentation standards
- **Continue systematic task-by-task progression** with user approval
- **Update this context** when user says "remember to [instruction]"

### Enforcement Requirements
All development work on this project must:
1. **Reference this project context** before creating or modifying any files
2. **Follow the directory structure** requirements without exception
3. **Update navigation** in parent README files when adding new documentation
4. **Validate all implementations** through testing before marking tasks complete
5. **Use ASCII characters only** in code, configuration files, and structured data
6. **Detect the current operating system** and use appropriate platform-specific commands
7. **Implement comprehensive Docker monitoring** for all platform containers
8. **Never commit sensitive information** to GitHub under any circumstances
9. **Update .gitignore** immediately when new file patterns need to be excluded
10. **Respond to 'push' command** by analyzing staged changes and executing git commit/push
11. **Update this project context** when user says "remember to [instruction]"

---

*This project context serves as the single source of truth for all development guidelines, user preferences, project status, and technical knowledge. It will be updated when the user provides "remember to" instructions.*
